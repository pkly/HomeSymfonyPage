version: "3"

services:
  lypage_php_prod:
    container_name: lypage_php_prod
    image: ghcr.io/pkly/ly-page/lypage-php-app:latest
    environment:
      - MASCOT_PATH=${MASCOT_PATH:-%kernel.project_path%/empty}
      - ADDITIONAL_TEMPLATE_PATH=${ADDITIONAL_TEMPLATE_PATH:-%kernel.project_path%/empty}
      - APP_ENV=prod

  lypage_nginx_prod:
    container_name: lypage_nginx_prod
    image: ghcr.io/pkly/ly-page/lypage-nginx:latest
    volumes:
      - ./logs/nginx:/var/log/nginx
    ports:
      - "${WEBSITE_PORT:-80}:80"

  lypage_cron_prod:
    container_name: lypage_cron_prod
    image: ghcr.io/pkly/ly-page/lypage-docker-with-compose:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    entrypoint: /sbin/tini --
    command: /usr/sbin/crond -f